<!DOCTYPE html>
<html lang="ko">
<head>
	<title>MoGL Test Suite - Primitive.js</title>
	<meta charset="utf-8"/>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<meta name="format-detection" content="telephone=no"/>
	<meta name="apple-mobile-web-app-capable" content="yes"/>
	<meta name="apple-mobile-web-app-status-bar-style" content="black"/>
	<meta name="viewport"
		  content="width=device-width,user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,target-densitydpi=medium-dpi"/>
	<link rel="stylesheet" type="text/css" href="css.css"/>

</head>
<body>
<div id="stage"></div>
<div id="result"></div>
<div id="test"></div>

<script src="../src/MoGL.js"></script>
<script src="../src/BlendMode.js"></script>
<script src="../src/Filter.js"></script>
<script src="../src/Vertex.js"></script>
<script src="../src/VertexShaderFunctions.js"></script>
<script src="../src/Matrix.js"></script>
<script src="../src/Geometry.js"></script>
<script src="../src/Material.js"></script>
<script src="../src/Texture.js"></script>
<script src="../src/Primitive.js"></script>
<script src="../src/Mesh.js"></script>
<script src="../src/Group.js"></script>
<script src="../src/Camera.js"></script>
<script src="../src/Scene.js"></script>
<script src="../src/World.js"></script>
<script src="http://js.bsapi.co/test/"></script>
<script>
var polygon, xyz = 3, xyzuv = 5;
bsTest('polygon',
			function () {
				// 삼각형이면 vs.length == 3
				polygon = Primitive.polygon(3, 1);
				return polygon.getVertexCount();
			}, 3,
			function () {
				// 삼각형이면 is.length == 1
				polygon = Primitive.polygon(3, 1);
				return polygon.getTriangleCount();
			}, 1,
			function () {
				// 사각형이면 vs.length == 4
				polygon = Primitive.polygon(4, 1);
				return polygon.getVertexCount();
			}, 4,
			function () {
				// 사각형이면 is.length == 2
				polygon = Primitive.polygon(4, 1);
				return polygon.getTriangleCount();
			}, 2,
			function () {
				// 오각형이면 vs.length == 5
				polygon = Primitive.polygon(5, 1);
				return polygon.getVertexCount();
			}, 5,
			function () {
				// 사각형이면 is.length == 3
				polygon = Primitive.polygon(5, 1);
				return polygon.getTriangleCount();
			}, 3,
			function () {
				// 홀수각형이면
				// n / 2 미만 번째 점의 x좌표 < 0
				// n / 2 이상 번째 점의 x좌표 > 0
				var vArr, checkPosNeg = true,
					n = 17, i;
				polygon = Primitive.polygon(n, 1);
				vArr = polygon._position;
				for (i = 1 ; i < n ; i++) {
					if (i < (n / 2))
						checkPosNeg = checkPosNeg && (vArr[i *= xyz] < 0);
					else
						checkPosNeg = checkPosNeg && (vArr[i *= xyz] > 0);
				}

				return checkPosNeg;
			}, true,
			function () {
				// 짝수각형이면
				// n / 2 미만 번째 점의 x좌표 < 0
				// n / 2 번째 점의 x 좌표 == 0
				// n / 2 초과 번째 점의 x좌표 > 0
				var vArr, checkPosNeg = true,
					n = 8, i;
				polygon = Primitive.polygon(n, 1);
				vArr = polygon._position;

				for (i = 1 ; i < n ; i++) {
					if (i < (n / 2))
						checkPosNeg = checkPosNeg && (vArr[i *= xyz] < 0);
					else if ( i == (n / 2))
						checkPosNeg = checkPosNeg && (Math.round(vArr[i *= xyz]) == 0);
					else
						checkPosNeg = checkPosNeg && (vArr[i *= xyz] > 0);
				}

				return checkPosNeg;
			}, true
);
</script>
<canvas id='polygon' width=500 height=500></canvas>
<script>
(function() {
	var world = new World('polygon'),
	scene = new Scene(),
	camera = new Camera(),
	solidWhite = new Material('#ffffff');

	world.addScene('scene', scene);
	scene.addChild('camera', camera);
	world.addRender('scene', 'camera');
	// scene.addMaterial('bitmapMat', new Material());
	scene.addTexture('texture1', '../asset/honey1.png');
	// scene.getMaterial('bitmapMat').addTexture(Texture.diffuse, 'texture1');

	var setMesh = function(n) {
		var polygon = Primitive.polygon(n, 2),
			// newMesh = new Mesh(polygon, solidWhite);
			newMesh = new Mesh(polygon, new Material().addTexture(Texture.diffuse, 'texture1'));
		scene.removeChild('polygon' + Math.max(3, n - 1));
		scene.addChild('polygon' + n, newMesh);
		newMesh.z = -5;
	};

	var start = 3, end = 15,
		intervalId;
	setMesh(start++);
	world.render();
	intervalId = setInterval( function() {
		if (start < end) {
			setMesh(start++);
			world.render();
		}
	}, 300);
	if (start == end)
		clearInterval(intervalId);
}());
</script>

<canvas id='sphere' width=500 height=500></canvas>
<script>
(function() {
    var world = new World('sphere'),
        scene = new Scene(),
        camera = new Camera();

    world.addScene('scene', scene);
    scene.addChild('camera', camera);
    world.addRender('scene', 'camera');
    scene.addMaterial('bitmapMat', new Material());
    scene.addTexture('texture1', '../asset/honey1.png');
    scene.getMaterial('bitmapMat').addTexture(Texture.diffuse, 'texture1');

    var sphere = Primitive.sphere(),

    newMesh = new Mesh(sphere, scene.getMaterial('bitmapMat'));
    scene.addChild('sphereMesh', newMesh);
    newMesh.z = -5;

    setInterval(function () {
        newMesh.rotateX += 0.01,
        newMesh.rotateY += 0.01,
        newMesh.rotateZ += 0.01;

        world.render();
    }, 1000 / 60)
}());
</script>
<hr/>

<img src="../src/ohno.png"/>
<div> // TODO 헉!! 노말도 계산해서 넘겨야되!!!</div>
<canvas id="canvasTest" height="256" width="512"></canvas>
<script>
	 document.getElementById('canvasTest').width = window.innerWidth;
	 document.getElementById('canvasTest').height = window.innerHeight;
//
	 var world = new World('canvasTest')
	 var scene = new Scene()


	 world.addScene('scene', scene)
	 scene.addChild('camera', new Camera())
	 scene.addTexture('texture', '../src/ohno.png')
	 world.addRender('scene', 'camera')

	 var material = new Material()
	 material.addTexture(Texture.diffuse, 'texture')
	 var mesh1 = new Mesh(Primitive.plane(2,2), new Material('#fff'))
	 mesh1.z = -5
	 mesh1.x = 0
	 scene.addChild('mesh1', mesh1)

//	var mesh2 = new Mesh(Primitive.sphere(12), material)
//	mesh2.z = -2
////	scene.addChild('mesh2', mesh2)
//
//	var mesh3 = new Mesh(Primitive.sphere(32), material)
//	mesh3.z = -2
//	mesh3.x = 1.5
//	scene.addChild('mesh3', mesh3)

	 setInterval(function () {
		 mesh1.rotateX += 0.01
		 mesh1.rotateY += 0.01
		 mesh1.rotateZ += 0.01
//		mesh2.rotateX += 0.01
//		mesh2.rotateY += 0.01
//		mesh2.rotateZ += 0.01
//		mesh3.rotateX += 0.01
//		mesh3.rotateY += 0.01
//		mesh3.rotateZ += 0.01
		 world.render();
	 }, 1000 / 60)

	 console.log('$$$$$$$$$$$$$$')
	 console.log(Primitive.plane())
</script>

</body>
</html>
